<!DOCTYPE html><html><head><meta charset='utf-8'><meta http-equiv='Access-Control-Allow-Headers' content='Origin, X-Requested-With, Content-Type, Accept'><meta http-equiv='Access-Control-Allow-Methods' content='GET,POST,PUT,DELETE,OPTIONS'><meta http-equiv='Access-Control-Allow-Origin' content='*'><meta http-equiv='Access-Control-Allow-Credentials' content='true'><script src='https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/marked.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/gameelements.js'></script><link rel='stylesheet' href='https://fustyles.github.io/webduino/SpBlocklyJS/css/icon_custom.css' /><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/spreadsheetsql.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/loader.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/TextToSpeech_20220729/texttospeech.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpeechRecognition_20220729/speechrecognition.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/line_20220729/line.js'></script></head><body>
<script>
const delay = (seconds) => {
    return new Promise((resolve) => {
        setTimeout(resolve, seconds * 1000);
    });
};
const main = async () => {
    var _E5_85_A7_E5_AE_B9, _E5_8A_9F_E8_83_BD_E6_A8_A1_E5_BC_8F, _E8_AA_9E_E9_9F_B3_E8_BE_A8_E8_AD_98_E9_87_8D_E5_95_9F_E8_A8_88_E6_99_82_E5_99_A8, Line_E6_AC_8A_E6_9D_96, _E9_81_B8_E5_96_AE_E6_96_87_E5_AD_97;

    // 描述此函式...
    function _E8_A1_A8_E5_96_AE_E5_85_83_E7_B4_A0_E5_88_9D_E5_A7_8B_E5_8C_96() {
        head_add_viewport(0.8, 1, 2, "yes");
        div_create('', 480, 95, 10, 200, "double", 10, '#3366ff', '#ffffff', '#ff0000', 18, 1, '', 99, true);
        button_create('OPEN', 250, 100, 140, 10, 1, null, '啟動語音助理', 30, 999, true);
        async function gamebutton_OPEN_onclick(event) {
            _E8_AA_9E_E9_9F_B3_E5_8A_A9_E7_90_86_E5_88_9D_E5_A7_8B_E5_8C_96();
        };
        document.getElementById("gamebutton_OPEN").addEventListener("click", gamebutton_OPEN_onclick, true);
    }

    // 描述此函式...
    function _E5_8A_9F_E8_83_BD_E6_A8_A1_E5_BC_8F_E5_88_9D_E5_A7_8B_E5_8C_96() {
        _E5_8A_9F_E8_83_BD_E6_A8_A1_E5_BC_8F = '';
        Line_E6_AC_8A_E6_9D_96 = 's78FLWGY1GFjNrzuEhtgHmIcfQmw4JKpksNjH4jSOnz';
        _E9_81_B8_E5_96_AE_E6_96_87_E5_AD_97 = ['請說出服務類別。"銀髮族的營養師"或"選單"可回到選單文字', '<br>', '(1)語音傳訊與拍照：親子溝通,傳送親情或特殊狀況"求救"。', '<br>', '(2)健康記錄：記錄每天身體狀況,運動量等。', '<br>'].join('');
        div_set('', "innerHTML", _E9_81_B8_E5_96_AE_E6_96_87_E5_AD_97);
        spreadsheet_insert("setcell", "", 1, 1, String('登入時間'), 'https://docs.google.com/spreadsheets/d/1DI_NeMvFzzwYvk-nONNlxBARShWUMc7vim1T_c2lEbg/edit?usp=sharing', '健康記錄', "https://script.google.com/macros/s/AKfycbxA3hhTlntwVTOcqngOC_iJL_zLmRwzcDbMYDs7FD8iinNsY9XZsMkD7AcXTIUbEc33EA/exec");
        spreadsheet_insert("setcell", "", 1, 2, String('健康狀況或運動量'), 'https://docs.google.com/spreadsheets/d/1DI_NeMvFzzwYvk-nONNlxBARShWUMc7vim1T_c2lEbg/edit?usp=sharing', '健康記錄', "https://script.google.com/macros/s/AKfycbxA3hhTlntwVTOcqngOC_iJL_zLmRwzcDbMYDs7FD8iinNsY9XZsMkD7AcXTIUbEc33EA/exec");
    }

    // 描述此函式...
    function _E8_AA_9E_E9_9F_B3_E5_8A_A9_E7_90_86_E5_88_9D_E5_A7_8B_E5_8C_96() {
        _E8_AA_9E_E9_9F_B3_E6_9C_97_E8_AE_80_E5_88_9D_E5_A7_8B_E5_8C_96();
        _E8_AA_9E_E9_9F_B3_E8_BE_A8_E8_AD_98_E5_88_9D_E5_A7_8B_E5_8C_96();
        _E6_9C_97_E8_AE_80_E6_96_87_E5_AD_97('語音助理已啟動，請說出服務類別。說出銀髮族的營養師或選單可回到選單文字');
    }

    // 描述此函式...
    function _E8_AA_9E_E9_9F_B3_E6_9C_97_E8_AE_80_E5_88_9D_E5_A7_8B_E5_8C_96() {
        ttsSetProperty(1, 1, 1, "cmn-Hant-TW");
        ttsSwitch(1);
    }

    // 描述此函式...
    async function _E8_AA_9E_E9_9F_B3_E8_BE_A8_E8_AD_98_E5_88_9D_E5_A7_8B_E5_8C_96() {
        recognition.lang = "cmn-Hant-TW";
        Recognition_switch(1);
        span_interim(0, 125, 20, 999, true);
        Recognition_recognitionFinish = async function() {
            if (((Recognition_final_get()).toLowerCase().indexOf('銀髮族的營養師'.toLowerCase()) != -1) || ((Recognition_final_get()).toLowerCase().indexOf('選單'.toLowerCase()) != -1)) {
                _E5_8A_9F_E8_83_BD_E6_A8_A1_E5_BC_8F = '';
                div_set('', "display", true);
                _E6_9C_97_E8_AE_80_E6_96_87_E5_AD_97('您好，請說出服務類別');
                div_set('', "innerHTML", _E9_81_B8_E5_96_AE_E6_96_87_E5_AD_97);
            } else if (_E5_8A_9F_E8_83_BD_E6_A8_A1_E5_BC_8F == '語音傳訊') {
                linenotify_push_message(Line_E6_AC_8A_E6_9D_96, {
                    'type': 'text',
                    'text': ('<br>' + String(Recognition_final_get()))
                });
                _E6_9C_97_E8_AE_80_E6_96_87_E5_AD_97('已傳送Line Notify');
                iframe_create('', 600, 600, 450, 100, "1", "yes", 'https://ap10.egame.kh.edu.tw/webbit/live-preview.html#gDWGyVLyXZbbgRlr3528', '', 1, 999, true);
                await delay(8);
                _E6_9C_97_E8_AE_80_E6_96_87_E5_AD_97('已拍照傳送Line Notify');
            } else if (_E5_8A_9F_E8_83_BD_E6_A8_A1_E5_BC_8F == '健康記錄') {
                _E6_9C_97_E8_AE_80_E6_96_87_E5_AD_97('開啟記錄');
                spreadsheet_insert("insertrow2", String("gmt_datetime") + "|" + String(Recognition_final_get()), 0, 0, "", 'https://docs.google.com/spreadsheets/d/1DI_NeMvFzzwYvk-nONNlxBARShWUMc7vim1T_c2lEbg/edit?usp=sharing', '健康記錄', "https://script.google.com/macros/s/AKfycbxA3hhTlntwVTOcqngOC_iJL_zLmRwzcDbMYDs7FD8iinNsY9XZsMkD7AcXTIUbEc33EA/exec");
                await delay(1);
                _E6_9C_97_E8_AE_80_E6_96_87_E5_AD_97('已記錄健康狀況');
            } else {
                if ((Recognition_final_get()) == '語音傳訊') {
                    _E5_8A_9F_E8_83_BD_E6_A8_A1_E5_BC_8F = '語音傳訊';
                    div_set('', "innerHTML", '');
                    div_set('', "display", false);
                    _E6_9C_97_E8_AE_80_E6_96_87_E5_AD_97('進入語音傳訊模式');
                } else if ((Recognition_final_get()) == '健康記錄' || (Recognition_final_get()) == '健康紀錄') {
                    _E5_8A_9F_E8_83_BD_E6_A8_A1_E5_BC_8F = '健康記錄';
                    div_set('', "innerHTML", '');
                    div_set('', "display", false);
                    _E6_9C_97_E8_AE_80_E6_96_87_E5_AD_97('進入健康記錄模式');
                }
            }

        };
    }

    // 描述此函式...
    function _E8_AA_9E_E9_9F_B3_E8_BE_A8_E8_AD_98_E4_BF_9D_E6_8C_81_E5_95_9F_E5_8B_95() {
        _E8_AA_9E_E9_9F_B3_E8_BE_A8_E8_AD_98_E9_87_8D_E5_95_9F_E8_A8_88_E6_99_82_E5_99_A8 = setInterval(async function() {
            if ((ttsSpeaking()) == false && (Recognition_state()) == false) {
                Recognition_switch(1);
            }
        }, 1000);
    }

    // 描述此函式...
    async function _E6_9C_97_E8_AE_80_E6_96_87_E5_AD_97(_E5_85_A7_E5_AE_B9) {
        Recognition_switch(0);
        await ttsSpeak(("Google 國語（臺灣）"), _E5_85_A7_E5_AE_B9);
    }


    _E8_A1_A8_E5_96_AE_E5_85_83_E7_B4_A0_E5_88_9D_E5_A7_8B_E5_8C_96();
    _E5_8A_9F_E8_83_BD_E6_A8_A1_E5_BC_8F_E5_88_9D_E5_A7_8B_E5_8C_96();
    _E8_AA_9E_E9_9F_B3_E8_BE_A8_E8_AD_98_E4_BF_9D_E6_8C_81_E5_95_9F_E5_8B_95();
};
main();
</script>
</body></html>